#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# COMPONENT-001 Pre-Commit Gate
# Blocks commits if documentation is stale

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘         COMPONENT-001 PRE-COMMIT GATE                    â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

# Change to frontend directory
cd projects/orion-sync-engine/frontend

# 1. Check if docs are fresh
echo "ğŸ” Checking documentation freshness..."
npm run docs:check
if [ $? -ne 0 ]; then
    echo "âŒ BLOCKED: Documentation is stale. Run 'npm run docs:sync' first."
    exit 1
fi

# 2. Run unit tests
echo "ğŸ§ª Running unit tests..."
npm run test:unit -- --run
if [ $? -ne 0 ]; then
    echo "âŒ BLOCKED: Unit tests failed."
    exit 1
fi

# 3. Lint check
echo "ğŸ“ Running lint..."
npm run lint
if [ $? -ne 0 ]; then
    echo "âŒ BLOCKED: Lint errors found."
    exit 1
fi

echo "âœ… All pre-commit checks passed!"
